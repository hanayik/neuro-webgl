(function(e){function n(n){for(var i,l,r=n[0],s=n[1],c=n[2],p=0,v=[];p<r.length;p++)l=r[p],Object.prototype.hasOwnProperty.call(a,l)&&a[l]&&v.push(a[l][0]),a[l]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);u&&u(n);while(v.length)v.shift()();return o.push.apply(o,c||[]),t()}function t(){for(var e,n=0;n<o.length;n++){for(var t=o[n],i=!0,r=1;r<t.length;r++){var s=t[r];0!==a[s]&&(i=!1)}i&&(o.splice(n--,1),e=l(l.s=t[0]))}return e}var i={},a={app:0},o=[];function l(n){if(i[n])return i[n].exports;var t=i[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,l),t.l=!0,t.exports}l.m=e,l.c=i,l.d=function(e,n,t){l.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,n){if(1&n&&(e=l(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(l.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)l.d(t,i,function(n){return e[n]}.bind(null,i));return t},l.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(n,"a",n),n},l.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},l.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],s=r.push.bind(r);r.push=n,r=r.slice();for(var c=0;c<r.length;c++)n(r[c]);var u=s;o.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"0d9a":function(e,n,t){},"3d54":function(e,n,t){"use strict";t("0d9a")},"56d7":function(e,n,t){"use strict";t.r(n);t("e260"),t("e6cf"),t("cca6"),t("a79d"),t("d1e78"),t("d4b8");var i=t("2b0e"),a=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("v-app",[t("v-app-bar",{attrs:{app:""}},[t("h2",[e._v("Niivue")]),t("v-spacer")],1),t("v-main",[t("v-row",{staticStyle:{height:"100%"}},[t("v-col",{attrs:{sm:"12",md:"12",lg:"4"}},[t("controls",{attrs:{overlays:e.urlOverlayList}})],1),t("v-col",{attrs:{sm:"12",md:"12",lg:"8"}},[t("v-toolbar",{staticClass:"pa-0 ma-0",attrs:{elevation:"0"}},[t("v-btn",{on:{click:function(n){return e.setSliceType(0)}}},[e._v("A")]),t("v-btn",{on:{click:function(n){return e.setSliceType(2)}}},[e._v("S")]),t("v-btn",{on:{click:function(n){return e.setSliceType(1)}}},[e._v("C")]),t("v-btn",{on:{click:function(n){return e.setSliceType(4)}}},[e._v("R")]),t("v-btn",{on:{click:function(n){return e.setSliceType(3)}}},[e._v("MP")]),t("v-spacer")],1),1==e.viewShown2D||1==e.viewShown3D?t("v-expansion-panels",[t("v-expansion-panel",[t("v-expansion-panel-header",[t("v-row",{staticClass:"align-center",attrs:{"no-gutters":""}},[e._v(" Controls "),t("v-icon",{staticClass:"mx-2"},[e._v(" mdi-arrow-expand-vertical ")])],1)],1),t("v-expansion-panel-content",[1==e.viewShown2D?t("v-row",[t("v-slider",{attrs:{step:"0.01",max:"1",min:"0","thumb-label":"",label:"slice"},on:{input:e.onSliceSlider2D},model:{value:e.sliceScrollVal,callback:function(n){e.sliceScrollVal=n},expression:"sliceScrollVal"}})],1):e._e(),1==e.viewShown3D?t("v-row",[t("v-slider",{attrs:{step:"1",max:"360",min:"0","thumb-label":"",label:"clip Azimu"},on:{input:e.onClipPlaneChange},model:{value:e.clipValAz,callback:function(n){e.clipValAz=n},expression:"clipValAz"}})],1):e._e(),1==e.viewShown3D?t("v-row",[t("v-slider",{attrs:{step:"1",max:"90",min:"-90","thumb-label":"",label:"clip Eleva"},on:{input:e.onClipPlaneChange},model:{value:e.clipValEl,callback:function(n){e.clipValEl=n},expression:"clipValEl"}})],1):e._e(),1==e.viewShown3D?t("v-row",[t("v-slider",{attrs:{step:"0.005",max:"0.5",min:"0","thumb-label":"",label:"clip Depth"},on:{input:e.onClipPlaneChange},model:{value:e.clipValDepth,callback:function(n){e.clipValDepth=n},expression:"clipValDepth"}})],1):e._e(),t("v-row",[e.viewShown3D?t("v-btn",{staticClass:"mx-auto",on:{click:e.onResetClipPlane}},[e._v("reset")]):e._e()],1)],1)],1)],1):e._e(),t("glviewer",{attrs:{overlays:e.urlOverlayList}})],1)],1)],1),t("v-footer",{attrs:{app:""}},[t("v-row",[t("v-col",{attrs:{align:"center",justify:"center"}},[t("span",{staticClass:"text-caption"},[e._v(e._s(e.coordinateString))])])],1)],1)],1)},o=[],l=(t("b680"),t("1276"),t("ac1f"),function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"mt-5",attrs:{id:"controls"}},[t("v-row",{staticClass:"my-2 mx-2 align-center"},[t("h3",[e._v("Layers")]),t("v-spacer"),t("v-btn",{staticClass:"mx-2",attrs:{small:""},on:{click:e.onAddOverlay}},[e._v("Add overlay")])],1),t("v-row",{attrs:{"no-gutters":""}},[t("v-expansion-panels",[t("draggable",{staticClass:"row mx-2 my-2",attrs:{handle:".drag-handle"},model:{value:e.overlays,callback:function(n){e.overlays=n},expression:"overlays"}},e._l(e.overlays,(function(n,i){return t("v-expansion-panel",{key:i},[t("v-expansion-panel-header",[t("v-row",{staticClass:"align-center",attrs:{"no-gutters":""}},[t("v-icon",{staticClass:"mx-2 drag-handle"},[e._v(" mdi-drag-horizontal-variant ")]),t("v-icon",{staticClass:"mx-2",on:{click:function(n){return n.stopPropagation(),e.toggleVisibility(i)}}},[e._v(e._s(e.visibilityIcon(e.overlays_[i].visible)))]),e._v(e._s(n.name)+" ")],1)],1),t("v-expansion-panel-content",[t("v-row",[t("v-select",{attrs:{items:e.colorMaps,label:"Color map"},on:{change:function(n){return e.onColorChange(i)}},model:{value:n.colorMap,callback:function(t){e.$set(n,"colorMap",t)},expression:"overlay.colorMap"}})],1),t("v-row",[t("v-col",{staticClass:"px-4"},[t("p",[e._v("Intensity range")]),t("v-range-slider",{staticClass:"align-center",attrs:{max:n.intensityMax,min:n.intensityMin,"hide-details":""},on:{input:function(t){return e.onIntensitySliderChange(i,[n.intensityRange[0],n.intensityRange[1]])}},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("v-text-field",{staticClass:"mt-0 pt-0",staticStyle:{width:"60px"},attrs:{value:n.intensityRange[0],"hide-details":"","single-line":"",type:"text",readonly:""},on:{input:function(t){return e.onIntensity0Change(i,n.intensityRange[0])}}})]},proxy:!0},{key:"append",fn:function(){return[t("v-text-field",{staticClass:"mt-0 pt-0",staticStyle:{width:"60px"},attrs:{value:n.intensityRange[1],"hide-details":"","single-line":"",type:"text",readonly:""},on:{input:function(t){return e.onIntensity1Change(i,n.intensityRange[1])}}})]},proxy:!0}],null,!0),model:{value:n.intensityRange,callback:function(t){e.$set(n,"intensityRange",t)},expression:"overlay.intensityRange"}})],1)],1),t("v-row",[t("v-col",[t("p",[e._v("Opacity")]),t("v-slider",{attrs:{step:"0.01",max:"1",min:"0","thumb-label":"",ticks:""},on:{input:function(t){return e.onOpacityChange(i,n.opacity)}},model:{value:n.opacity,callback:function(t){e.$set(n,"opacity",t)},expression:"overlay.opacity"}})],1)],1)],1)],1)})),1)],1)],1)],1)}),r=[],s=t("b76a"),c=t.n(s),u=new i["a"],p={props:{overlays:Array},name:"controls",components:{draggable:c.a},data:function(){return{colorMaps:["gray","Winter","Warm","Plasma","Viridis","Inferno"],eyeIcon:"mdi-eye",overlays_:this.overlays,draggable:!0,opacity:1,overlayVisibilityState:{}}},methods:{toggleVisibility:function(e){if(1!==this.overlays_.length){this.$set(this.overlays_[e],"visible",!this.overlays_[e].visible);var n=this.overlays_[e].visible;n?u.$emit("opacity-change",{volIdx:e,newOpacity:1}):u.$emit("opacity-change",{volIdx:e,newOpacity:0})}},visibilityIcon:function(e){return e?"mdi-eye":"mdi-eye-off"},onColorChange:function(){u.$emit("colormap-change")},onOpacityChange:function(e,n){u.$emit("opacity-change",{volIdx:e,newOpacity:n})},onIntensity0Change:function(e,n){u.$emit("intensity-change",{volIdx:e,newRangeArr:[n,this.overlays[e].intensityMax]})},onIntensity1Change:function(e,n){u.$emit("intensity-change",{volIdx:e,newRangeArr:[this.overlays[e].intensityMin,n]})},onIntensitySliderChange:function(e,n){u.$emit("intensity-change",{volIdx:e,newRangeArr:n})},onAddOverlay:function(){alert("adding overlays in this demo is not implemented yet! :)")}},mounted:function(){var e=this;u.$on("intensity-range-update",(function(n){e.overlays[n.volIdx].intensityMin=n.newRangeArr[0],e.overlays[n.volIdx].intensityMax=n.newRangeArr[1],e.overlays[n.volIdx].intensityRange=n.newRangeArr,e.$forceUpdate()}))}},v=p,d=(t("3d54"),t("2877")),h=t("6544"),y=t.n(h),g=t("8336"),m=t("62ad"),f=t("cd55"),w=t("49e2"),b=t("c865"),x=t("0393"),C=t("132d"),V=t("5963"),S=t("0fd9"),_=t("b974"),M=t("ba0d"),D=t("2fa4"),$=t("8654"),R=Object(d["a"])(v,l,r,!1,null,"e2396cda",null),P=R.exports;y()(R,{VBtn:g["a"],VCol:m["a"],VExpansionPanel:f["a"],VExpansionPanelContent:w["a"],VExpansionPanelHeader:b["a"],VExpansionPanels:x["a"],VIcon:C["a"],VRangeSlider:V["a"],VRow:S["a"],VSelect:_["a"],VSlider:M["a"],VSpacer:D["a"],VTextField:$["a"]});var k=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"viewer",attrs:{id:"viewer"}},[t("v-dialog",{attrs:{"max-width":"400"},model:{value:e.dialog,callback:function(n){e.dialog=n},expression:"dialog"}},[t("v-color-picker",{attrs:{width:"400",mode:"rgba"},on:{input:e.onCrosshairColorChange},model:{value:e.crosshairColor,callback:function(n){e.crosshairColor=n},expression:"crosshairColor"}})],1),t("v-dialog",{attrs:{"max-width":"400"},model:{value:e.discoMode,callback:function(n){e.discoMode=n},expression:"discoMode"}},[t("v-card",{attrs:{color:"rgba(0, 0, 0, 0.4)"}},[t("v-row",{attrs:{"no-gutters":""}},[t("v-spacer"),t("h2",{staticStyle:{color:"white"}},[e._v("Disco mode")]),t("v-spacer")],1)],1)],1)],1)},O=[],I=t("c7dc"),A={name:"glviewer",props:{overlays:Array,shader:String},created:function(){},data:function(){return{niivue:null,selectedOverlay:0,last2DSliceVal:.5,mouseDown:!1,touchDown:!1,zDown:!1,discoMode:!1,discoModeColorMapTimer:null,discoModeCrosshairTimer:null,scale:1,dialog:!1,crosshairColor:{r:255,g:0,b:0,a:1},colorMaps:["Winter","Warm","Plasma","Viridis","Inferno"],selectedColorMap:"Winter"}},methods:{setNewPos:function(){var e=this.niivue.frac2mm([this.niivue.scene.crosshairPos[0],this.niivue.scene.crosshairPos[1],this.niivue.scene.crosshairPos[2]]);u.$emit("mm-change",e)},onWindowResize:function(){var e=100,n=document.querySelector("#gl"),t=document.querySelector("#viewer");n.width=t.clientWidth,n.height=t.clientHeight,t.getBoundingClientRect().bottom>document.documentElement.clientHeight&&(t.style.height=document.documentElement.clientHeight-e,n.height=document.documentElement.clientHeight-e),this.niivue.drawScene()},onCrosshairColorChange:function(){var e=[this.crosshairColor.r/255,this.crosshairColor.g/255,this.crosshairColor.b/255,this.crosshairColor.a];this.niivue.setCrosshairColor(e)}},mounted:function(){var e=this,n=document.createElement("canvas");n.classList.add("fillParent");var t=document.querySelector("#viewer");n.id="gl",n.width=t.clientWidth,n.height=t.clientHeight,t.appendChild(n),this.niivue=new I["Niivue"]({}).attachTo("gl"),this.niivue.resizeListener=this.onWindowResize,window.addEventListener("resize",this.niivue.resizeListener.bind(this)),this.niivue.loadVolumes(this.overlays),setTimeout((function(){for(var n=0;n<e.overlays.length;n++){console.log("intensity-range-update"),console.log(e.overlays[n].cal_max),e.overlays[n].intensityRange=[e.overlays[n].cal_min,e.overlays[n].cal_max];var t=[e.overlays[n].cal_min,e.overlays[n].cal_max];console.log(e.overlays[n].intensityRange),u.$emit("intensity-range-update",{volIdx:n,newRangeArr:t})}}),3e3),console.log("blah"),u.$on("opacity-change",(function(n){e.niivue.setOpacity(n.volIdx,n.newOpacity)})),u.$on("intensity-change",(function(n){e.overlays[n.volIdx].cal_min=n.newRangeArr[0],e.overlays[n.volIdx].cal_max=n.newRangeArr[1],e.niivue.updateGLVolume(e.overlays)})),u.$on("slice-type-change",function(e){this.niivue.setSliceType(e)}.bind(this)),u.$on("set-2D-slice",function(e){this.niivue.sliceScroll2D(e,null,null,!1)}.bind(this)),u.$on("set-clip-planes",function(e){this.niivue.clipPlaneUpdate(e)}.bind(this)),u.$on("colormap-change",function(){this.niivue.loadVolumes(this.overlays)}.bind(this)),u.$on("refresh",function(){this.niivue.updateGLVolume(this.overlays)}.bind(this))}},E=A,z=(t("d3cb"),t("b0af")),T=t("03a4"),j=t("169a"),L=Object(d["a"])(E,k,O,!1,null,"4d4ed2a3",null),W=L.exports;y()(L,{VCard:z["a"],VColorPicker:T["a"],VDialog:j["a"],VRow:S["a"],VSpacer:D["a"]});var q={name:"App",components:{controls:P,glviewer:W},created:function(){var e=this;u.$on("mm-change",(function(n){e.coordinateString=n[0].toFixed(2)+"×"+n[1].toFixed(2)+"×"+n[2].toFixed(2)}))},data:function(){return{tab:null,viewShown2D:!1,viewShown3D:!1,clipValAz:0,clipValEl:0,clipValDepth:.5,sliceScrollVal:.5,appTabs:["Menu","Draw","Edit","Scripting"],coordinateString:"0x0x0",overlayList:[{url:"./mni152.nii.gz",volume:{hdr:null,img:null},name:"mni125.nii.gz",intensityMin:0,intensityMax:100,intensityRange:[0,100],colorMap:"gray",opacity:100,visible:!0},{url:"./hippo.nii.gz",volume:{hdr:null,img:null},name:"hippo.nii.gz",intensityMin:0,intensityMax:100,intensityRange:[0,100],colorMap:"Winter",opacity:100,visible:!0},{url:"./hippolr.nii.gz",volume:{hdr:null,img:null},name:"hippolr.nii.gz",intensityMin:0,intensityMax:100,intensityRange:[0,100],colorMap:"Warm",opacity:100,visible:!0}]}},computed:{urlOverlayList:function(){var e=[];if(void 0===this.$route.query.urls||null===this.$route.query.urls||""===this.$route.query.urls)return this.overlayList;for(var n=this.$route.query.urls.split(","),t=0;t<n.length;t++)e.push({url:n[t],volume:{hdr:null,img:null},name:n[t].split("/").pop(),intensityMin:0,intensityMax:100,intensityRange:[0,100],colorMap:"gray",opacity:100,visible:!0});return e.length>0?(u.$emit("refresh"),e):this.overlayList}},methods:{setSliceType:function(e){e<3?(this.viewShown2D=!0,this.viewShown3D=!1):4==e?(this.viewShown2D=!1,this.viewShown3D=!0):(this.viewShown2D=!1,this.viewShown3D=!1),u.$emit("slice-type-change",e)},onSliceSlider2D:function(){this.viewShown2D&&u.$emit("set-2D-slice",this.sliceScrollVal)},onClipPlaneChange:function(){this.viewShown3D&&u.$emit("set-clip-planes",[this.clipValAz,this.clipValEl,this.clipValDepth])},onResetClipPlane:function(){this.viewShown3D&&(this.clipValAz=0,this.clipValEl=0,this.clipValDepth=2,u.$emit("set-clip-planes",[this.clipValAz,this.clipValEl,this.clipValDepth]))}}},H=q,F=t("7496"),B=t("40dc"),N=t("553a"),G=t("f6c4"),J=t("71d9"),U=Object(d["a"])(H,a,o,!1,null,null,null),K=U.exports;y()(U,{VApp:F["a"],VAppBar:B["a"],VBtn:g["a"],VCol:m["a"],VExpansionPanel:f["a"],VExpansionPanelContent:w["a"],VExpansionPanelHeader:b["a"],VExpansionPanels:x["a"],VFooter:N["a"],VIcon:C["a"],VMain:G["a"],VRow:S["a"],VSlider:M["a"],VSpacer:D["a"],VToolbar:J["a"]});var Q=t("8c4f"),X=(t("5363"),t("f309"));t("bf40");i["a"].use(X["a"]);var Y=new X["a"]({icons:{iconfont:"mdi"}});i["a"].use(Q["a"]),i["a"].config.productionTip=!1;var Z=new Q["a"]({routes:[],mode:"history"});new i["a"]({vuetify:Y,router:Z,render:function(e){return e(K)}}).$mount("#app")},"57e3":function(e,n,t){},d3cb:function(e,n,t){"use strict";t("57e3")}});
//# sourceMappingURL=app.487684a0.js.map